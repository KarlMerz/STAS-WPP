function [yi,dyi] = bicub (xi,y,y1,y2,y12,xv)

wt = [1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0; ...
      0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0; ...
     -3,  0,  0,  3,  0,  0,  0,  0, -2,  0,  0, -1,  0,  0,  0,  0; ...
      2,  0,  0, -2,  0,  0,  0,  0,  1,  0,  0,  1,  0,  0,  0,  0; ...
      0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0; ...
      0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0; ...
      0,  0,  0,  0, -3,  0,  0,  3,  0,  0,  0,  0, -2,  0,  0, -1; ...
      0,  0,  0,  0,  2,  0,  0, -2,  0,  0,  0,  0,  1,  0,  0,  1; ...
     -3,  3,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0; ...
      0,  0,  0,  0,  0,  0,  0,  0, -3,  3,  0,  0, -2, -1,  0,  0; ...
      9, -9,  9, -9,  6,  3, -3, -6,  6, -6, -3,  3,  4,  2,  1,  2; ...
     -6,  6, -6,  6, -4, -2,  2,  4, -3,  3,  3, -3, -2, -1, -1, -2; ...
      2, -2,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0; ...
      0,  0,  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  1,  1,  0,  0; ...
     -6,  6, -6,  6, -3, -3,  3,  3, -4,  4,  2, -2, -2, -2, -1, -1; ...
      4, -4,  4, -4,  2,  2, -2, -2,  2, -2, -2,  2,  1,  1,  1,  1];

d1 = xv(2,1) - xv(1,1);
d2 = xv(3,2) - xv(2,2);
cs = wt*[y;y1*d1;y2*d2;y12*d1*d2];

c = [cs(1:4) cs(5:8) cs(9:12) cs(13:16)].';

t = (xi(:,1) - xv(1,1))/d1;
u = (xi(:,2) - xv(2,2))/d2;

Np = size(xi,1);
yi = zeros(Np,1);
dyi = zeros(Np,2);

for jj = 4:-1:1

   yi = t.*yi + ((c(jj,4)*u + c(jj,3)).*u + c(jj,2)).*u + c(jj,1);
   dyi(:,2) = t.*dyi(:,2) + (3*c(jj,4)*u + 2*c(jj,3)).*u + c(jj,2);
   dyi(:,1) = u.*dyi(:,1) + (3*c(4,jj)*t + 2*c(3,jj)).*t + c(2,jj);

end

dyi(:,1) = dyi(:,1)/d1;
dyi(:,2) = dyi(:,2)/d2;
